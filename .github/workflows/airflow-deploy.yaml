# # .github/workflows/airflow-deploy.yml
# name: Deploy to Airflow
# on:
#   push:
#     branches: [main]

# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v2
      
#       - name: Create Kubernetes Secret
#         uses: appleboy/ssh-action@master
#         with:
#           host: ${{ secrets.TAILSCALE_IP }}
#           username: ${{ secrets.K8S_USERNAME }}
#           key: ${{ secrets.K8S_SSH_KEY }}
#           script: |
#             # Secret YAML에 환경변수 주입
#             envsubst < k8s/secrets/airflow-env-vars.yaml | kubectl apply -f -
      
#       - name: Deploy Airflow
#         uses: appleboy/ssh-action@master
#         with:
#           host: ${{ secrets.TAILSCALE_IP }}
#           username: ${{ secrets.K8S_USERNAME }}
#           key: ${{ secrets.K8S_SSH_KEY }}
#           script: |
#             cd /path/to/airflow/config
#             git pull
#             helm upgrade airflow apache-airflow/airflow \
#               --namespace airflow \
#               --values k8s/values.yaml